---
layout: col-document
title: WSTG - Стабільний
tags: WSTG
---

# Тестування слабких функцій зміни або скидання пароля

|ID          |
|------------|
|WSTG-ATHN-09|

## Короткий огляд

Функція зміни та скидання пароля в додатках дозволяє користувачам самостійно змінювати або скидати паролі без втручання адміністратора. Зміна паролів зазвичай відбувається в додатку, а скидання паролів може відбуватися через додаток або надсилатися користувачеві електронною поштою. Це може свідчити про те, що паролі зберігаються у вигляді відкритого тексту або в розшифровуваному форматі.

## Мета тестування

- Перевірити стійкість додатку до маніпуляцій із процесом зміни пароля, які дозволяють змінити пароль іншого користувача.
- Оцінити функцію скидання пароля на предмет вразливостей до вгадування або обходу.

## Як тестувати

Для функцій зміни та скидання пароля важливо перевірити:

1. Чи можуть користувачі, окрім адміністраторів, змінювати або скидати паролі для чужих акаунтів.
2. Чи можуть користувачі маніпулювати процесом зміни або скидання пароля, щоб змінити або скинути пароль іншого користувача або адміністратора.
3. Чи вразлива функція зміни або скидання пароля до [CSRF](../06-Session_Management_Testing/05-Testing_for_Cross_Site_Request_Forgery.md).

### Тестування скидання пароля

Окрім попередніх перевірок, важливо звернути увагу на наступне:

- Яку інформацію необхідно надати для скидання пароля?

  Перший крок — перевірити, чи потрібні секретні питання. Якщо пароль або посилання для скидання пароля надсилаються електронною поштою без попереднього запиту секретного питання, це означає повну залежність від безпеки електронної пошти, що може бути недостатнім для додатків з високим рівнем безпеки.

  Якщо використовуються секретні питання, необхідно оцінити їхню силу. Цей аспект детально описаний у розділі [Тестування слабких питань/відповідей на питання безпеки](08-Testing_for_Weak_Security_Question_Answer.md).

- Як скинутий пароль передається користувачеві?

  Найменш безпечний варіант — це коли інструмент скидання пароля показує старий пароль; це дозволяє зловмиснику увійти в обліковий запис, і користувач не дізнається про компрометацію свого облікового запису, якщо додаток не надає інформації про останній вхід.

  Краще, якщо інструмент скидання пароля змушує користувача негайно змінити пароль. Хоча цей варіант менш прихований, він все ж дозволяє зловмиснику отримати доступ і заблокувати справжнього користувача.

  Найвищий рівень безпеки досягається, коли скидання пароля здійснюється через електронну пошту, яку користувач вказав при реєстрації, або іншу електронну адресу. Це змушує зловмисника не лише вгадати, на яку адресу надіслано скидання, але й отримати доступ до цієї електронної пошти.

- Чи генеруються скинуті паролі випадковим чином?

  Найбільш небезпечний варіант — це коли додаток надсилає або відображає старий пароль у відкритому тексті, що свідчить про те, що паролі не зберігаються в хешованому вигляді, що саме по собі є проблемою безпеки.

- Чи вимагає функція скидання пароля підтвердження перед зміною пароля?

  Щоб обмежити атаки відмови в обслуговуванні, додаток повинен надсилати посилання з випадковим токеном, і тільки після його відвідування процес скидання завершується. Це гарантує, що поточний пароль залишатиметься дійсним до підтвердження скидання.

### Тестування зміни пароля

Окрім попередніх перевірок важливо переконатися:

- Чи запитується старий пароль для завершення зміни?

  Найбільш небезпечний сценарій — коли додаток дозволяє змінити пароль без запиту поточного пароля. Якщо зловмисник отримав контроль над сеансом, він може легко змінити пароль жертви.
  Дивіться також розділ [Тестування слабкої політики паролів](07-Testing_for_Weak_Password_Policy.md) цього керівництва.

## Рекомендації

Функція зміни або скидання пароля є чутливою і вимагає захисту, наприклад, запитувати повторну автентифікацію або надавати користувачеві екран підтвердження під час процесу.

## Посилання

- [OWASP Forgot Password Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html)