---
layout: col-document
title: WSTG - Стабільний
tags: WSTG
---

# Тестування на слабку відповідь на питання безпеки

|ID          |
|------------|
|WSTG-ATHN-08|

## Короткий огляд

Так звані "секретні" питання та відповіді часто використовуються для відновлення забутих паролів (див. [Тестування слабких механізмів зміни або скидання паролів](09-Testing_for_Weak_Password_Change_or_Reset_Functionalities.md)), або як додаткова безпека на додаток до пароля.

Зазвичай вони генеруються під час створення облікового запису, і користувачеві потрібно вибрати із запропонованих питань та надати відповідь. Можуть також дозволяти користувачеві створювати свої власні пари питання-відповідь. Обидва методи схильні до вразливостей. Ідеально, питання безпеки повинні мати відповіді, відомі лише користувачеві, і не повинні бути вгадуваними або доступними іншим. Це складніше, ніж здається.

### Попередньо створені питання

Більшість попередньо створених питань є досить простими і можуть призвести до небезпечних відповідей. Наприклад:

- Відповіді можуть бути відомі членам сім'ї або близьким друзям користувача, напр. "Дівоче прізвище вашої матері?" або "Дата вашого народження?"
- Відповіді можуть бути легко вгадувані, напр. "Ваш улюблений колір?" або "Ваша улюблена бейсбольна команда?"
- Відповіді можуть бути зламані методом грубої сили, напр. "Ім'я вашого улюбленого шкільного вчителя?" — відповідь може бути виявлена в списках популярних імен.
- Відповіді можуть бути публічно доступними, напр. "Ваш улюблений фільм?" — відповідь може бути знайдена на сторінці профілю користувача в соціальних мережах.

### Самостійно створені питання

Проблема з дозволом користувачам створювати свої питання полягає в тому, що вони можуть створити дуже небезпечні питання або навіть обійти всю суть наявності питання безпеки. Приклади реальних питань:

- "Скільки буде 1+1?"
- "Яке ваше ім'я користувача?"
- "Мій пароль — S3cur|ty!"

## Мета тестування

- Визначити складність та рівень простоти питань.
- Оцінити можливі відповіді користувачів та здатність до злому методом грубої сили.

## Як тестувати

### Тестування на слабкі попередньо створені питання

Спробуйте отримати список питань безпеки, створивши новий обліковий запис або пройшовши процес "Я не пам'ятаю свій пароль". Генеруйте якомога більше питань для розуміння типів питань безпеки. Якщо питання підпадають під вразливі категорії, вони можуть бути атаковані (вгадування, злом методом грубої сили, доступність у соціальних мережах тощо).

### Тестування на слабкі самостійно створені питання

Спробуйте створити питання, створивши новий обліковий запис або налаштувавши параметри відновлення пароля для вашого облікового запису. Якщо система дозволяє користувачеві створювати власні питання, це вразливість. Якщо такі питання використовуються під час функції скидання пароля і можна перерахувати імена користувачів (див. [Тестування на перерахування акаунтів](../03-Identity_Management_Testing/04-Testing_for_Account_Enumeration_and_Guessable_User_Account.md)), тоді можна очікувати виявлення кількох слабких питань.

### Тестування на злам відповіді методом грубої сили

Використовуйте методи, описані в [Тестуванні слабкого механізму блокування](03-Testing_for_Weak_Lock_Out_Mechanism.md), щоб визначити, чи спрацьовує механізм блокування після декількох невірних відповідей на запитання безпеки.

Перше, що потрібно врахувати під час експлуатації питань безпеки, — це кількість запитань, на які необхідно відповісти. У більшості додатків користувачеві потрібно відповісти лише на одне запитання, тоді як у критичних додатках може знадобитися відповісти на два або більше.

Наступний крок — оцінити силу питань безпеки. Чи можна отримати відповіді за допомогою простого пошуку в Google або атаки методом соціальної інженерії? Ось покрокова інструкція для тестувальника на проникнення, як експлуатувати схему запитань безпеки:

- Чи дозволяє додаток користувачеві вибирати питання, на яке потрібно відповісти? Якщо так, зосередьтеся на запитаннях, які:

  - Мають "публічну" відповідь; наприклад, таку, яку можна знайти за допомогою простого пошуку в пошуковій системі.
  - Мають фактичну відповідь, таку як "перша школа" або інші факти, які можна знайти.
  - Мають небагато можливих відповідей, наприклад, "модель вашого першого автомобіля". Такі запитання дають зловмисникові короткий список можливих відповідей, і на основі статистики можна ранжувати відповіді від найімовірнішої до найменш імовірної.

- Визначте кількість можливих спроб, якщо це можливо.
  - Чи дозволяє скидання пароля необмежену кількість спроб?
  - Чи є період блокування після X кількості неправильних відповідей? Враховуйте, що система блокування може бути проблемою безпеки сама по собі, оскільки її можна використати для атаки відмови в обслуговуванні проти легітимних користувачів.
  - Оберіть відповідне запитання на основі аналізу з попередніх пунктів і проведіть дослідження для визначення найімовірніших відповідей.

Ключем до успішної експлуатації та обходу слабкої схеми питань безпеки є знаходження такого питання або набору питань, які дають можливість легко знайти відповіді. Завжди шукайте запитання, які дають найбільшу статистичну ймовірність вгадати правильну відповідь, якщо ви взагалі не впевнені в жодній із відповідей. Наприкінці схема питань безпеки настільки сильна, наскільки сильне її найслабше питання.

## Посилання

- [The Curse of the Secret Question](https://www.schneier.com/essay-081.html)
- [The OWASP Security Questions Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Choosing_and_Using_Security_Questions_Cheat_Sheet.html)
