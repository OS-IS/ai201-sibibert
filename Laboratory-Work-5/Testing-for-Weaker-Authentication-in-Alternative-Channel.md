---
layout: col-document
title: WSTG - Стабільний
tags: WSTG
---

# Тестування на слабку автентифікацію в альтернативних каналах

|ID          |
|------------|
|WSTG-ATHN-10|

## Короткий огляд

Навіть якщо основні механізми автентифікації не містять вразливостей, вони можуть бути присутні в альтернативних каналах автентифікації для тих самих облікових записів. Потрібно виконати тестування для виявлення таких каналів та, якщо дозволяє область тестування, ідентифікувати вразливості.

Альтернативні канали можуть використовуватися для обходу основного каналу або для розкриття інформації, яка може бути використана для атаки на основний канал. Ці канали можуть бути окремими веб-додатками з різними доменними іменами або шляхами. Наприклад:

- Стандартний вебсайт
- Оптимізований для мобільних пристроїв сайт
- Сайт, оптимізований для доступності
- Вебсайти для інших країн або мов
- Паралельні вебсайти, які використовують ті самі облікові записи користувачів (наприклад, інший вебсайт із додатковим функціоналом тієї ж організації)
- Версії сайту для розробки, тестування, UAT та інсценування

Крім того, це можуть бути й інші типи додатків або бізнес-процесів:

- Мобільні додатки
- Додатки для настільних комп'ютерів
- Оператори кол-центрів
- Системи голосового відгуку або телефонні дерева

Зверніть увагу, що цей тест зосереджений на альтернативних каналах; деякі альтернативні варіанти автентифікації можуть виглядати як інший контент, що постачається через той самий вебсайт, і, безумовно, підпадають під область тестування. Вони не розглядаються тут детально, і повинні були бути ідентифіковані під час збору інформації та основного тестування автентифікації. Наприклад:

- Прогресивне збагачення та поступове спрощення, які змінюють функціональність.
- Використання сайту без кукі.
- Використання сайту без JavaScript.
- Використання сайту без плагінів, таких як Flash і Java.

Навіть якщо область тестування не дозволяє перевірити альтернативні канали, їх існування має бути задокументовано. Це може підірвати рівень впевненості в механізмах автентифікації та стати приводом для додаткового тестування.

## Приклад

Основний вебсайт — `http://www.example.com`, і функції автентифікації завжди відбуваються на сторінках із використанням TLS `https://www.example.com/myaccount/`.

Однак існує окремий сайт, оптимізований для мобільних пристроїв, який не використовує TLS і має слабший механізм відновлення пароля `http://m.example.com/myaccount/`.

## Мета тестування

- Ідентифікувати альтернативні канали автентифікації.
- Оцінити рівень безпеки та можливі вразливості в альтернативних каналах.

## Як тестувати

### Зрозуміти основний механізм

Повністю протестуйте основні функції автентифікації вебсайту. Це має ідентифікувати, як створюються, змінюються або відновлюються облікові записи, паролі та інші механізми автентифікації. Знання цих деталей є необхідним для порівняння з будь-якими альтернативними каналами.

### Ідентифікувати інші канали

Альтернативні канали можна знайти за допомогою наступних методів:

- Читання контенту сайту, особливо домашньої сторінки, сторінок "Зв'яжіться з нами", сторінок підтримки та FAQ, файлів robots.txt та sitemap.xml.
- Пошук у логах HTTP-проксі, записаних під час збору інформації, за такими ключовими словами, як "mobile", "android", "iphone", "auth", "sso".
- Використання пошукових систем для пошуку інших вебсайтів тієї ж організації з автентифікаційними механізмами.

Для кожного можливого каналу підтвердіть, чи використовуються одні й ті ж облікові записи користувачів, або чи надають вони доступ до тієї самої або подібної функціональності.

### Перевірка функцій автентифікації

Для кожного альтернативного каналу перевірте, чи поділяються облікові записи користувачів або функціональність. Для зручності можна створити таблицю, як показано нижче:

  | Основний | Мобільний |  Кол-центр | Вебсайт-партнер |
  |---------|-----------|------------|-----------------|
  | Реєстрація| Так      |     -      |       -         |
  | Вхід     | Так      |    Так     |    Так (SSO)    |
  | Вихід    |   -      |     -      |       -         |
  | Скидання пароля | Так |   Так    |       -         |
  | Зміна пароля    |   -   |   Так  |       -         |

У цьому прикладі мобільний сайт має додаткову функцію «зміна пароля», але не пропонує «вихід». Також можна виконати обмежену кількість завдань, зателефонувавши до кол-центру. Кол-центри можуть бути цікавими, оскільки перевірка особи там може бути слабшою, ніж на вебсайті, що дозволяє використовувати цей канал для допомоги в атаці на обліковий запис користувача.

Під час перерахування цих каналів варто звернути увагу на те, як здійснюється управління сесіями, щоб визначити, чи є перекриття між каналами (наприклад, кукі, прив'язані до одного й того ж домену, дозволені одночасні сесії в різних каналах, але не в одному і тому ж каналі).

## Перегляд та тестування

Альтернативні канали повинні бути згадані у звіті про тестування, навіть якщо вони позначені як "тільки інформація" або "поза межами тестування". Якщо тестування дозволено, всі інші тести автентифікації з цього керівництва повинні бути виконані та порівняні з основним каналом.

## Схожі тести

Слід використовувати всі інші тестові випадки для автентифікації.

## Рекомендації

Забезпечте єдину політику автентифікації на всіх каналах, щоб усі канали мали однаковий рівень безпеки.
